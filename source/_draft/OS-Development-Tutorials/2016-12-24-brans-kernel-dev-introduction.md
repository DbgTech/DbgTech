---
title: 《内核开发》之介绍
date: 2016-12-24 11:41:28
tags:
- 操作系统
- 翻译
categories:
- 内核
- 翻译
---

### 介绍 ###

内核开发不是一件容易的任务。它对于你的编程经验是相当的考验：开发内核就是说你需要立即如何构建软件，提供硬件接口，并且要管理硬件。内核是操作系统的核心 —— 管理着硬件提供的资源。

内核需要管理的最重要的系统资源就是处理器或叫CPU —— 这是一种这样的形式，给特定的操作分时间槽，当一个调度事件发生时，可以中断一个任务或进程。实现了多任务。有协作的多任务，程序自己可以调用"yield"函数来放弃处理器时间给下一个可执行的进程或任务。也有抢占式的多任务，系统定时器可以打断当前的进程，从而转向新的进程：一种强制性地切换，这种方式可以保证一个进程有时间片去执行。有几种调度算法用于选择列表内下一个要执行的进程。最简单的方式叫做"Round Robin"。这种方式就仅仅是从队列中取出下一个进程，并且切换进程，让它执行。更加复杂的调度器涉及到优先级，当然了高优先级的任务比低优先级任务有更多执行的时间。更加复杂的调度算法就是实时调度器了。这种算法用于保证特定的进程能够拥有最低限度的运行时间的环境。总而言之，这个最重要的资源要按时计算来使用。

除了CPU，系统中最重要的资源就很明显了：内存。有一些情况下，内存非常紧缺，而CPU时间却是无有限的，那么内存比CPU时间就更加珍贵。你可以在设计内核时，设计成为内存完美利用，要求使用更多CPU时间。或者将系统设计为CPU有效利用，当然这就需要内存来存储缓存，在使用时可以快速获取所需的数据而不需要逐一检索。最好的方式应该是两者的结合：尽力做到内存的优化使用，同时保留尽可能多的CPU时间。

内核需要管理的最后一样资源就是硬件资源。其中包括中断请求（IRQs），IRQs是一种特殊信号，像键盘和硬盘可以用来告诉CPU去执行特定的程序处理他们已经准备好的数据。另外一个硬件资源是DMA通道。DMA通道可以让设备锁定内存总线，直接传输数据到系统内存，而不需要打断处理器的执行。有一个提高系统性能的好方法：DMA使得设备在不需要打断CPU的情况下传输数据，然后使用IRQ中断CPU，告诉CPU数据传输已经完成。声卡和网卡都使用了IRQ和DMA通道。第三个硬件资源是以地址形式，像内存一样，但是它是以端口的形式存在的I/O总线地址。设备可以通过它的I/O端口进行配置，读取数据或者输出数据。一个设备可以使用很多个I/O端口，典型的是8到16个不等的一连串端口的形式存在。
<!-- more -->
#### 概览 ####

这篇教程旨在向读者展示如何建立内核的基础结构与内容。包括：

&emsp;&emsp;1）设置开发环境
&emsp;&emsp;2）基础：设置GRUB阶段
&emsp;&emsp;3）链接其他的文件，并调用main()
&emsp;&emsp;4）打印文字到屏幕
&emsp;&emsp;5）设置GDT
&emsp;&emsp;6）设置IDT
&emsp;&emsp;7）设置ISRs处理中断和IRQs
&emsp;&emsp;8）重新映射可编程控制器PIC到IDT条目
&emsp;&emsp;9）安装和服务IRQs
&emsp;&emsp;10）映射可编程中断定时器/系统时钟（PIT）
&emsp;&emsp;11）映射键盘IRQs和处理键盘数据
&emsp;&emsp;12）接下来就看你的了

By Andy @ 2016/12/24 10:24:17